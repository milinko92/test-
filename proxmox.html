<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Proxmox + Arch VM | Kubernix</title>
  <meta name="description" content="Proxmox virtualization and Arch Linux VM setup guide.">
  <link rel="stylesheet" href="style.css">
  <style>
    /* Page-specific light touches that complement style.css */
    .hero {
      padding: 2rem 1.25rem 1rem;
      border-bottom: 1px solid #30363d;
      background: #2a3138;
    }
    .container {
      max-width: 980px;
      margin: 0 auto;
      padding: 1.25rem;
    }
    .badges {
      display: flex;
      gap: .5rem;
      flex-wrap: wrap;
      margin-top: .5rem;
    }
    .badge {
      padding: .2rem .5rem;
      border: 1px solid #444c56;
      border-radius: 999px;
      font-size: .85rem;
      color: #a5d6ff;
    }
    .toc {
      border: 1px solid #444c56;
      background: #2f363d;
      border-radius: 6px;
      padding: .75rem 1rem;
      margin: 1rem 0 2rem;
    }
    .toc a { text-decoration:none; }
    code, pre {
      background: #2f363d;
      border: 1px solid #444c56;
      border-radius: 6px;
    }
    pre { padding: .75rem 1rem; overflow-x:auto; }
    .grid-2 {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }
    @media (min-width: 900px) {
      .grid-2 { grid-template-columns: 1fr 1fr; }
    }
    footer {
      margin-top: 3rem;
      border-top: 1px solid #30363d;
      padding: 1.25rem;
      color: #9aa7b3;
      font-size: .95rem;
      text-align:center;
    }
  </style>
</head>
<body>
  <!-- Navbar is injected by main.js; we keep a placeholder element -->
  <nav class="menus"></nav>

  <header class="hero">
    <div class="container">
      <h1>Proxmox + Arch VM</h1>
      <p>Proxmox VE virtualization with a clean Arch Linux VM for homelab workloads.</p>
      <div class="badges">
        <span class="badge">Proxmox VE</span>
        <span class="badge">Arch Linux</span>
        <span class="badge">KVM/QEMU</span>
        <span class="badge">Cloud-Init (optional)</span>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="toc">
      <strong>Table of Contents</strong>
      <ol>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#requirements">Requirements</a></li>
        <li><a href="#prepare-proxmox">Prepare Proxmox</a></li>
        <li><a href="#create-vm">Create the VM</a></li>
        <li><a href="#install-arch">Install Arch Linux</a></li>
        <li><a href="#post-install">Post‑install</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
      </ol>
    </section>

    <section id="overview">
      <h2>Overview</h2>
      <p>This guide walks through uploading an Arch ISO to Proxmox, creating a KVM VM with VirtIO devices, installing Arch with a simple layout, and applying a few post‑install tweaks useful for homelab servers.</p>
    </section>

    <section id="requirements">
      <h2>Requirements</h2>
      <div class="grid-2">
        <div>
          <h3>You’ll need</h3>
          <ul>
            <li>Proxmox VE host (latest stable recommended)</li>
            <li>Arch Linux ISO (download from a mirror)</li>
            <li>Network connectivity and a storage pool (local-lvm or directory)</li>
          </ul>
        </div>
        <div>
          <h3>Recommendations</h3>
          <ul>
            <li>Use <em>VirtIO</em> for disk &amp; NIC for performance.</li>
            <li>Enable <em>Q35 + OVMF (UEFI)</em> for modern firmware support.</li>
            <li>Prefer <em>Cloud-Init</em> if you want to automate first-boot config.</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="prepare-proxmox">
      <h2>Prepare Proxmox</h2>
      <ol>
        <li><strong>Upload ISO:</strong> In Proxmox UI → <em>Datacenter &gt; Storage</em> → pick ISO storage (e.g., <code>local</code>) → <em>ISO Images</em> → <em>Upload</em> → select Arch ISO.</li>
        <li><strong>Create a Linux Bridge</strong> (if you don’t already): <em>Datacenter &gt; Node &gt; System &gt; Network</em> → add <code>linux bridge</code> attached to your NIC (e.g., <code>vmbr0</code>).</li>
      </ol>
    </section>

    <section id="create-vm">
      <h2>Create the VM</h2>
      <ol>
        <li><strong>Create VM</strong>:
          <ul>
            <li><em>General:</em> Node = your host, ISO = Arch ISO.</li>
            <li><em>System:</em> Machine = Q35, BIOS = OVMF (UEFI), SCSI Controller = VirtIO SCSI (single).</li>
            <li><em>Disks:</em> Bus/Device = VirtIO Block, Size = e.g. 32–64&nbsp;GB.</li>
            <li><em>CPU:</em> 2–4 cores (host type), <em>Memory:</em> 2–4&nbsp;GB to start.</li>
            <li><em>Network:</em> Model = VirtIO (paravirtualized), Bridge = vmbr0.</li>
          </ul>
        </li>
        <li><strong>Start</strong> the VM and open the <em>Console</em>.</li>
      </ol>
    </section>

    <section id="install-arch">
      <h2>Install Arch Linux</h2>
      <p>At the Arch live prompt, consider this streamlined approach (adapt as needed):</p>
<pre><code># Sync clock
timedatectl set-ntp true

# Partition (single disk example: /dev/vda)
# Use cfdisk or parted to create: EFI (512M, type ef00) + root (rest)
cfdisk /dev/vda

# Format
mkfs.fat -F32 /dev/vda1
mkfs.ext4 /dev/vda2

# Mount
mount /dev/vda2 /mnt
mkdir -p /mnt/boot
mount /dev/vda1 /mnt/boot

# Base install
pacstrap -K /mnt base linux linux-firmware vim networkmanager

# Fstab
genfstab -U /mnt &gt;&gt; /mnt/etc/fstab

# Chroot
arch-chroot /mnt

# Locale, time, hostname
ln -sf /usr/share/zoneinfo/Europe/Belgrade /etc/localtime
hwclock --systohc
sed -i 's/^#en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/' /etc/locale.gen
locale-gen
echo 'LANG=en_US.UTF-8' &gt; /etc/locale.conf
echo 'arch-vm' &gt; /etc/hostname

# Networking
systemctl enable NetworkManager

# Bootloader (systemd-boot with UEFI)
bootctl install
cat &gt; /boot/loader/loader.conf &lt;&lt;EOF
default arch
timeout 3
editor 0
EOF
cat &gt; /boot/loader/entries/arch.conf &lt;&lt;EOF
title   Arch Linux
linux   /vmlinuz-linux
initrd  /initramfs-linux.img
options root=PARTUUID=$(blkid -s PARTUUID -o value /dev/vda2) rw
EOF

# Root password
passwd

exit
umount -R /mnt
reboot
</code></pre>
      <p>After reboot, log in as <code>root</code> and create a regular user.</p>
    </section>

    <section id="post-install">
      <h2>Post‑install</h2>
      <ul>
        <li>Install QEMU guest tools: <code>pacman -S qemu-guest-agent</code> and <code>systemctl enable --now qemu-guest-agent</code>.</li>
        <li>Update packages: <code>pacman -Syu</code>.</li>
        <li>SSH: <code>pacman -S openssh &amp;&amp; systemctl enable --now sshd</code>.</li>
        <li>Optional: set static IP in NetworkManager or reserve DHCP on your router/firewall.</li>
      </ul>
    </section>

    <section id="troubleshooting">
      <h2>Troubleshooting</h2>
      <ul>
        <li><strong>No boot after install:</strong> Ensure BIOS = OVMF (UEFI) and the EFI partition is mounted at <code>/boot</code> for systemd‑boot.</li>
        <li><strong>No network:</strong> NIC model must be <em>VirtIO</em>; inside Arch, verify <code>nmcli device</code> and service status of NetworkManager.</li>
        <li><strong>Clock drift:</strong> Confirm host time sync and inside guest run <code>timedatectl status</code>.</li>
      </ul>
    </section>

    <button id="toTop" aria-label="Back to top">↑ Top</button>
  </main>

  <footer>
    © 2025 Kubernix — All Rights Reserved
  </footer>

  <script src="main.js"></script>
</body>
</html>
