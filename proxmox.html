<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proxmox</title>
  <link rel="stylesheet" href="style.css">
<style>
	:root {
		--bg: #30363d;
		--surface: #24292f;
		--text: #e6edf3;
		--muted: #9aa4b2;
		--primary: #a5d6ff;
		--primary-10: rgba(165,214,255,.12);
		--accent: #ffcc8a;
		--border: #3a4149;
		--focus: #7fb5ff;
		--radius: 14px;
		--shadow: 0 10px 30px rgba(0,0,0,.35);
	}
	@media (prefers-reduced-motion: no-preference){ :root{ scroll-behavior: smooth; } }
	html,body{height:100%}
	body{
		margin:0;
		font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
		color: var(--text);
		background: var(--bg);
		line-height: 1.55;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
	}
	.wrap{max-width: 1000px; margin: 0 auto; padding: 32px 16px;}
	header{
		position: sticky; top:0; z-index:20;
		backdrop-filter: blur(6px);
		background: color-mix(in oklab, var(--surface) 85%, #000 15% / 85%);
		border-bottom: 1px solid var(--border);
	}
	header .bar{display:flex; align-items:center; justify-content:space-between; gap:16px; padding:14px 0;}
	.brand{font-weight:800; letter-spacing:.5px; font-size: clamp(18px, 3vw, 22px); color: var(--text)}
	.tag{color: var(--muted); font-weight:500}
	nav .menus{display:flex; gap:10px; flex-wrap:wrap}
	details{
		position:relative; display:inline-block;
		border:1px solid var(--border); border-radius:10px; background: var(--surface);
		padding:6px 10px;
		margin-right: 8px;
	}
	details > summary{list-style:none; cursor:pointer; outline:none; color: var(--text);}
	details[open] > summary,
	details:hover > summary {
		border-bottom:1px dashed var(--border);
		background: var(--primary-10);
		border-radius: 10px 10px 0 0;
	}
	details ul{
		position:absolute; left:0; top: calc(100% + 2px);
		margin:0; padding:8px 0; list-style:none;
		background: var(--surface);
		border:1px solid var(--border); border-radius:10px;
		box-shadow: 0 10px 24px rgba(0,0,0,.45);
		width: max-content;
		min-width: 200px;
		z-index: 50;
		pointer-events: auto;
		opacity: 1;
		font-size: 1.05em;
		transition: opacity 0.18s cubic-bezier(.4,0,.2,1);
		letter-spacing: 0.01em;
	}
	details:not([open]):not(:hover) ul {
		pointer-events: none;
		opacity: 0;
		transition: opacity 0.18s cubic-bezier(.4,0,.2,1);
	}
	details[open]:hover ul,
	details[open]:focus-within ul,
	details:hover ul,
	details:focus-within ul {
		pointer-events: auto;
		opacity: 1;
		transition: opacity 0.18s cubic-bezier(.4,0,.2,1);
	}
	details ul li{margin:0; padding:0}
	details ul li a{display:block; padding:6px 10px; text-decoration:none; white-space: nowrap;}
	details ul li a:hover{background: color-mix(in oklab, var(--primary) 12%, transparent); border-radius:8px; text-decoration:none}
	a{color: var(--primary); text-decoration: none}
	a:hover{text-decoration: underline}
	a:focus-visible, button:focus-visible, summary:focus-visible, [tabindex]:focus-visible{
		outline: 2px solid var(--focus);
		outline-offset: 2px;
		border-radius: 6px;
	}
	.paper{
		background: var(--surface);
		border: 1px solid var(--border);
		border-radius: var(--radius);
		box-shadow: var(--shadow);
		padding: 28px;
	}
	.infobox{
		float:right; width:min(280px, 40%); margin: 0 0 16px 24px;
		background: color-mix(in oklab, var(--surface) 85%, #000 15%);
		border:1px solid var(--border); border-radius:12px; padding:12px 14px;
		font-size: 14px; color: var(--text);
	}
	.infobox h3{margin:.2rem 0 .4rem 0; font-size:16px; color: var(--accent)}
	.infobox table{width:100%; border-collapse: collapse}
	.infobox td{padding:6px 8px; border-bottom:1px dashed var(--border)}
	.infobox td:first-child{color: var(--muted); white-space: nowrap; padding-right:12px;}
	h1{margin: 0 0 8px 0; font-size: clamp(26px, 4vw, 34px)}
	h2{margin-top: 26px; font-size: 20px; border-bottom: 1px solid var(--border); padding-bottom:6px; color: var(--accent)}
	p{line-height:1.7}
	ul{line-height:1.7}
	.badge{display:inline-block; padding:2px 8px; border-radius:999px; background: var(--primary-10); color: var(--primary); border:1px solid color-mix(in oklab, var(--primary) 35%, #000 65%)}
	footer{border-top:1px solid var(--border); color: var(--muted); font-size:14px; padding:18px 0; margin-top:32px}
	@media (prefers-reduced-motion: reduce){ *{animation: none !important; transition: none !important} }
	@media (max-width: 780px){ .infobox{float:none; width:100%; margin: 0 0 16px 0} }
	</style>
</head>
<body>
  <header>
    <div class="wrap bar">
      <div>
        <div class="brand">Proxmox + Arch VM</div>
        <div class="tag">Proxmox virtualization and Arch Linux VM setup.</div>
      </div>
      <nav class="menus">
        <details>
          <summary>Gear</summary>
          <ul>
            <li><a href="gear.html">Desktop PC</a></li>
            <li><a href="homelabpcs.html">Homelab PCs</a></li>
            <li><a href="raspberrypi.html">Raspberry Pi</a></li>
            <li><a href="#">Switch</a></li>
            <li><a href="#">Router</a></li>
          </ul>
        </details>
        <details>
          <summary>Projects</summary>
          <ul>
            <li><a href="raspberrypi.html">Pi-hole with Unbound</a></li>
            <li><a href="proxmox.html">Proxmox</a></li>
          </ul>
        </details>
        <details>
          <summary>Resources</summary>
          <ul>
            <li><a href="https://github.com/milinko92/kubernix.github.io/tree/main" target="_blank" rel="noopener">GitHub Page</a></li>
            <li><a href="https://blog.kubernix.com" target="_blank" rel="noopener">Personal Blog</a></li>
          </ul>
        </details>
      </nav>
    </div>
  </header>
  
  <main class="wrap">
    <section class="paper">
      <h2>Proxmox</h2>
       <section id="overview">
      <h2>Overview</h2>
      <p>This guide walks through uploading an Arch ISO to Proxmox, creating a KVM VM with VirtIO devices, installing Arch with a simple layout, and applying a few post‑install tweaks useful for homelab servers.</p>
    </section>

    <section id="requirements">
      <h2>Requirements</h2>
      <div class="grid-2">
        <div>
          <h3>You’ll need</h3>
          <ul>
            <li>Proxmox VE host (latest stable recommended)</li>
            <li>Arch Linux ISO (download from a mirror)</li>
            <li>Network connectivity and a storage pool (local-lvm or directory)</li>
          </ul>
        </div>
        <div>
          <h3>Recommendations</h3>
          <ul>
            <li>Use <em>VirtIO</em> for disk &amp; NIC for performance.</li>
            <li>Enable <em>Q35 + OVMF (UEFI)</em> for modern firmware support.</li>
            <li>Prefer <em>Cloud-Init</em> if you want to automate first-boot config.</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="prepare-proxmox">
      <h2>Prepare Proxmox</h2>
      <ol>
        <li><strong>Upload ISO:</strong> In Proxmox UI → <em>Datacenter &gt; Storage</em> → pick ISO storage (e.g., <code>local</code>) → <em>ISO Images</em> → <em>Upload</em> → select Arch ISO.</li>
        <li><strong>Create a Linux Bridge</strong> (if you don’t already): <em>Datacenter &gt; Node &gt; System &gt; Network</em> → add <code>linux bridge</code> attached to your NIC (e.g., <code>vmbr0</code>).</li>
      </ol>
    </section>

    <section id="create-vm">
      <h2>Create the VM</h2>
      <ol>
        <li><strong>Create VM</strong>:
          <ul>
            <li><em>General:</em> Node = your host, ISO = Arch ISO.</li>
            <li><em>System:</em> Machine = Q35, BIOS = OVMF (UEFI), SCSI Controller = VirtIO SCSI (single).</li>
            <li><em>Disks:</em> Bus/Device = VirtIO Block, Size = e.g. 32–64&nbsp;GB.</li>
            <li><em>CPU:</em> 2–4 cores (host type), <em>Memory:</em> 2–4&nbsp;GB to start.</li>
            <li><em>Network:</em> Model = VirtIO (paravirtualized), Bridge = vmbr0.</li>
          </ul>
        </li>
        <li><strong>Start</strong> the VM and open the <em>Console</em>.</li>
      </ol>
    </section>

    <section id="install-arch">
      <h2>Install Arch Linux</h2>
      <p>At the Arch live prompt, consider this streamlined approach (adapt as needed):</p>
<pre><code># Sync clock
timedatectl set-ntp true

# Partition (single disk example: /dev/vda)
# Use cfdisk or parted to create: EFI (512M, type ef00) + root (rest)
cfdisk /dev/vda

# Format
mkfs.fat -F32 /dev/vda1
mkfs.ext4 /dev/vda2

# Mount
mount /dev/vda2 /mnt
mkdir -p /mnt/boot
mount /dev/vda1 /mnt/boot

# Base install
pacstrap -K /mnt base linux linux-firmware vim networkmanager

# Fstab
genfstab -U /mnt &gt;&gt; /mnt/etc/fstab

# Chroot
arch-chroot /mnt

# Locale, time, hostname
ln -sf /usr/share/zoneinfo/Europe/Belgrade /etc/localtime
hwclock --systohc
sed -i 's/^#en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/' /etc/locale.gen
locale-gen
echo 'LANG=en_US.UTF-8' &gt; /etc/locale.conf
echo 'arch-vm' &gt; /etc/hostname

# Networking
systemctl enable NetworkManager

# Bootloader (systemd-boot with UEFI)
bootctl install
cat &gt; /boot/loader/loader.conf &lt;&lt;EOF
default arch
timeout 3
editor 0
EOF
cat &gt; /boot/loader/entries/arch.conf &lt;&lt;EOF
title   Arch Linux
linux   /vmlinuz-linux
initrd  /initramfs-linux.img
options root=PARTUUID=$(blkid -s PARTUUID -o value /dev/vda2) rw
EOF

# Root password
passwd

exit
umount -R /mnt
reboot
</code></pre>
      <p>After reboot, log in as <code>root</code> and create a regular user.</p>
    </section>

    <section id="post-install">
      <h2>Post‑install</h2>
      <ul>
        <li>Install QEMU guest tools: <code>pacman -S qemu-guest-agent</code> and <code>systemctl enable --now qemu-guest-agent</code>.</li>
        <li>Update packages: <code>pacman -Syu</code>.</li>
        <li>SSH: <code>pacman -S openssh &amp;&amp; systemctl enable --now sshd</code>.</li>
        <li>Optional: set static IP in NetworkManager or reserve DHCP on your router/firewall.</li>
      </ul>
    </section>

    <section id="troubleshooting">
      <h2>Troubleshooting</h2>
      <ul>
        <li><strong>No boot after install:</strong> Ensure BIOS = OVMF (UEFI) and the EFI partition is mounted at <code>/boot</code> for systemd‑boot.</li>
        <li><strong>No network:</strong> NIC model must be <em>VirtIO</em>; inside Arch, verify <code>nmcli device</code> and service status of NetworkManager.</li>
        <li><strong>Clock drift:</strong> Confirm host time sync and inside guest run <code>timedatectl status</code>.</li>
      </ul>
    </section>
    </section>
  </main>

  <footer class="wrap">
    © 2025 Kubernix — All Rights Reserved
  </footer>

<script>
(function(){
  const menus = document.querySelector('nav.menus');
  if (!menus) return;
  const items = Array.from(menus.querySelectorAll('details'));
  function closeAll(except){
    items.forEach(d => { if (d !== except) d.removeAttribute('open'); });
  }
  items.forEach(d => {
    d.addEventListener('mouseenter', () => { d.setAttribute('open',''); closeAll(d); });
    d.addEventListener('mouseleave', () => { d.removeAttribute('open'); });
  });
  document.addEventListener('click', (e) => {
    if (!e.target.closest('nav.menus')) closeAll();
  });
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeAll();
  });
})();
</script>
<button id="toTop" aria-label="Back to top" title="Back to top">↑ Top</button>
	<script>
(function(){
  const toTop = document.getElementById('toTop');
  if (!toTop) return;

  const showAfter = 300; // px scrolled before showing
  const onScroll = () => {
    if (window.scrollY > showAfter) {
      toTop.classList.add('show');
    } else {
      toTop.classList.remove('show');
    }
  };
  window.addEventListener('scroll', onScroll, { passive: true });
  onScroll();

  toTop.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
    // close any open dropdowns (same behavior as gear)
    document.querySelectorAll('nav.menus details[open]').forEach(d => d.removeAttribute('open'));
  });
})();
</script>
  <script src="main.js"></script>
</body>
</html>
